<div class="planner-container">

  <!-- Form View -->
  <div *ngIf="!generatedPlan && !isGenerating">
    <h2 class="form-title">Personalized Evacuation Planner</h2>
    <p class="text-center text-muted mb-4">Enter your current situation to generate a tailored preparedness plan.</p>

    <form (ngSubmit)="generatePlan()">
      <div class="mb-3">
        <label for="houseType" class="form-label">What is your housing situation?</label>
        <select id="houseType" name="houseType" class="form-control" [(ngModel)]="form.houseType" required>
          <option value="" disabled>Select your house type...</option>
          <option value="1BHK Apartment">1BHK Apartment</option>
          <option value="2BHK Apartment">2BHK Apartment</option>
          <option value="3BHK+ Apartment">3BHK+ Apartment</option>
          <option value="Independent Home">Independent Home</option>
          <option value="Villa">Villa</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="peopleCount" class="form-label">How many people are in your household?</label>
        <input type="number" id="peopleCount" name="peopleCount" class="form-control" [(ngModel)]="form.peopleCount" min="1" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Your Location:</label>
        <div class="location-group">
          <button type="button" class="btn btn-secondary" (click)="getLocation()">Get Current Location</button>
          <p class="location-message">{{ locationMessage }}</p>
        </div>
      </div>

      <button type="submit" class="btn btn-primary" [disabled]="!form.houseType || !form.location">
        Generate My Plan
      </button>
    </form>
  </div>

  <!-- Loading View -->
  <div *ngIf="isGenerating" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Analyzing your situation and generating a personalized plan...</p>
  </div>

  <!-- Results View -->
  <div *ngIf="generatedPlan">
    <h2 class="results-title">{{ generatedPlan.title }}</h2>

    <!-- Risk Zone Alert -->
    <div *ngIf="generatedPlan.riskZoneInfo" class="alert alert-danger">
      <strong>URGENT ALERT:</strong> Your location is within a high-risk flood zone: <strong>{{ generatedPlan.riskZoneInfo.properties.area }}</strong>.
      Please follow the instructions below with increased urgency.
    </div>

    <!-- Immediate Actions Section -->
    <div class="results-section">
      <h5>Immediate Actions</h5>
      <ul>
        <li *ngFor="let action of generatedPlan.immediateActions">{{ action }}</li>
      </ul>
    </div>

    <!-- Evacuation Kit Section -->
    <div class="results-section">
      <h5>Evacuation Kit Checklist</h5>
      <ul>
        <li *ngFor="let item of generatedPlan.evacuationKit">{{ item }}</li>
      </ul>
    </div>

    <!-- Action Buttons Section -->
    <div class="results-actions">
      <a [href]="generatedPlan.evacuationRouteLink" target="_blank" class="btn btn-success">
        View Evacuation Route
      </a>
      <button (click)="startOver()" class="btn btn-outline-secondary">Start Over</button>
    </div>
  </div>

</div>

